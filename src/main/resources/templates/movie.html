<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/root.html}"
      lang="en">
<head>
    <title th:text="${tmdbMovie.title}">Movie Details</title>
</head>
<body>
    <section layout:fragment="content">

        <!-- TMDB data -->
        <h1 th:text="${tmdbMovie.title}"></h1>
        <p th:text="${tmdbMovie.id}"></p>

        <div th:if="${ourMovie != null}">
            <!-- Delete and edit buttons -->
            <a th:href="@{/movies/{movieId}/update(movieId=${ourMovie.id})}">Edit movie</a>

            <form th:action="@{/movies/{movieId}(movieId=${ourMovie.id})}"
                  th:method="delete"
                  onsubmit="return confirm('Are you sure you want to delete this movie? It will also delete all characters for the movie.');">
                <button type="submit">Delete movie</button>
            </form>

            <!-- Movie test results -->
            <div th:each="question : ${ourMovie.questions}">
                <p th:text="${question.question.displayText}"></p>
                <!-- <p th:text="${question.question.extendedDisplayText}"></p>   https://www.w3schools.com/bootstrap4/bootstrap_tooltip.asp  -->
                <p th:text="${question.answer}"></p>
                <p th:text="${question.details}"></p>
            </div>

            <!-- List out the movie characters -->
            <div th:if="${not #lists.isEmpty(ourMovie.movieCharacters)}">
                <h2>Characters</h2>
                <div th:each="character : ${ourMovie.movieCharacters}">
                    <p th:text="${character.character.name}"></p>
                    <a th:href="@{/movies/{movieId}/characters/{movieCharacterId}(movieId=${ourMovie.id},movieCharacterId=${character.id})}">View</a>
                </div>
            </div>
            <div th:if="${#lists.isEmpty(ourMovie.movieCharacters)}">
                <p>
                    We don't have any gender-queer characters for this movie listed in our system.
                </p>
            </div>
            <a th:href="@{/movies/{movieId}/characters/create(movieId=${ourMovie.id})}">Add new character</a>
        </div>

        <div th:if="${ourMovie == null}">
            <p>
                We don't have this movie listed in our system.
                <a th:href="@{/movies/create(tmdbId=${tmdbMovie.id})}">Add it now!</a>
            </p>
        </div>
    </section>
</body>
</html>
